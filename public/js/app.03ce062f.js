(function(t){function e(e){for(var r,s,o=e[0],c=e[1],u=e[2],d=0,p=[];d<o.length;d++)s=o[d],a[s]&&p.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(p.length)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={app:0},i=[];function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"91da":function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper",attrs:{id:"app"}},[n("loading",{attrs:{"show-loading":t.showLoading}}),n("main",{staticClass:"main-content container text-center"},[n("h2",{staticClass:"vab-litle"},[t._v("氣象局氣象語音答詢系統")]),n("microphone"),n("router-view")],1)],1)},i=[],s=(n("ac6a"),n("d4ec")),o=n("bee2"),c=n("99de"),u=n("7e84"),l=n("262e"),d=n("9ab4"),p=n("60a3"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showLoading?n("div"):t._e()},h=[],v=function(t){function e(){return Object(s["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),e}(p["d"]);d["a"]([Object(p["c"])({default:!1})],v.prototype,"showLoading",void 0),v=d["a"]([Object(p["a"])({name:"loading"})],v);var m=v,b=m,w=(n("fa76"),n("2877")),g=Object(w["a"])(b,f,h,!1,null,"05e9fc34",null);g.options.__file="Loading.vue";var y=g.exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vab-microphone"},[n("button",{on:{mousedown:t.startRecording,mouseup:t.stopRecording,touchstart:t.startRecording,touchend:t.stopRecording}},[n("i",{staticClass:"fa fa-microphone",attrs:{"aria-hidden":"true"}})])])},j=[],_=(n("7f7f"),n("96cf"),n("1da1")),x=n("86c9"),C=n.n(x),R=function(){function t(){Object(s["a"])(this,t);var e=window.AudioContext||window.webkitAudioContext;this.audioContent=new e,this.URL=window.URL||window.webkitURL}return Object(o["a"])(t,[{key:"startRecording",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getRecorder();case 2:e=t.sent,e.record();case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"stopRecording",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRecorder();case 2:r=t.sent,r.stop(),r.exportWAV(function(t){n(t),r.clear()});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"getDuration",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(e){var n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var r=document.createElement("audio");r.addEventListener("loadeddata",function(e){t(parseFloat(e.currentTarget.duration)),document.body.removeChild(r)}),r.src=n.URL.createObjectURL(e),r.style.visibility="hidden",r.style.position="absolute",r.style.left="-10000px",r.style.top="0",document.body.appendChild(r)}));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRecorder",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.recorder){t.next=2;break}return t.abrupt("return",this.recorder);case 2:return t.next=4,navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 4:return e=t.sent,this.recorder=new C.a(this.audioContent.createMediaStreamSource(e),{numChannels:1}),t.abrupt("return",this.recorder);case 7:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}]),t}(),k=n("bc3a"),$=n.n(k),L=function(){function t(){Object(s["a"])(this,t)}return Object(o["a"])(t,[{key:"query",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(e){var n,r,a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=(new Date).toISOString()+".wav",r=new FormData,r.append("sound",e,n),t.next=5,$()({method:"post",url:"/api/olami/query",data:r,headers:{"Content-Type":"multipart/form-data"}});case 5:return a=t.sent,i=a.data.data.asr.result,s=a.data.data.nli[0].desc_obj.result,t.abrupt("return",{asr:i,nli:s});case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"speech",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,$()({method:"post",url:"/api/olami/speech",data:{text:e}});case 2:return n=t.sent,t.abrupt("return","".concat(n.data.file_path).concat(n.data.file_name));case 4:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),E=n("1e5c"),S=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new L;Object(s["a"])(this,t),this.client=e}return Object(o["a"])(t,[{key:"say",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=E["Howl"],t.next=3,this.client.speech(e);case 3:t.t1=t.sent,t.t2={src:t.t1},n=new t.t0(t.t2),n.once("load",function(){n.play()});case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),P=function(t){function e(){return Object(s["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(o["a"])(e,[{key:"startRecording",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.recorder.startRecording();case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"stopRecording",value:function(){var t=Object(_["a"])(regeneratorRuntime.mark(function t(){var e,n,r,a,i,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.$parent.$emit("showLoading",!0),t.next=4,this.recorder.stopRecording();case 4:return e=t.sent,t.next=7,this.recorder.getDuration(e);case 7:if(n=t.sent,!(n<=1||n===1/0)){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,this.client.query(e);case 12:if(r=t.sent,a=r.asr,i=r.nli,this.$parent.$emit("olami",a,i),"home"!==this.$route.name){t.next=19;break}return t.next=19,this.speaker.say(i);case 19:t.next=23;break;case 21:t.prev=21,t.t0=t["catch"](0);case 23:return t.prev=23,setTimeout(function(){return s.$parent.$emit("showLoading",!1)},200),t.finish(23);case 26:case"end":return t.stop()}},t,this,[[0,21,23,26]])}));function e(){return t.apply(this,arguments)}return e}()}]),e}(p["d"]);d["a"]([Object(p["b"])({default:new L})],P.prototype,"client",void 0),d["a"]([Object(p["b"])({default:new R})],P.prototype,"recorder",void 0),d["a"]([Object(p["b"])({default:new S})],P.prototype,"speaker",void 0),P=d["a"]([Object(p["a"])({name:"microphone"})],P);var M=P,q=M,A=Object(w["a"])(q,O,j,!1,null,null,null);A.options.__file="Microphone.vue";var T=A.exports,U=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.showLoading=!0,t}return Object(l["a"])(e,t),Object(o["a"])(e,[{key:"mounted",value:function(){var t=this;this.$on("olami",function(e,n){return t.$children.forEach(function(t){return t.$emit("olami",e,n)})}),this.$on("showLoading",function(e){return t.showLoading=e}),this.showLoading=!1}}]),e}(p["d"]);U=d["a"]([Object(p["a"])({components:{Loading:y,Microphone:T}})],U);var D=U,F=D,N=Object(w["a"])(F,a,i,!1,null,null,null);N.options.__file="App.vue";var H=N.exports,X=n("8c4f"),J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{action:""}},[n("div",{staticClass:"input-group text-center say-password"},[n("div",{staticClass:"row"},[t._m(0),n("div",{staticClass:"col-md-12"},[n("div",{staticClass:"col-md-6 col-md-push-3"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.asr,expression:"asr"}],staticClass:"form-control vab-input",class:{"input-success":"success"===t.status,"input-failed":"failed"===t.status},attrs:{type:"text",placeholder:"您說的內容會顯示於此處",readonly:"readonly"},domProps:{value:t.asr},on:{input:function(e){e.target.composing||(t.asr=e.target.value)}}})]),"success"===t.status?n("div",{staticClass:"col-md-2 col-md-push-3"},[n("router-link",{staticClass:"btn next-btn",attrs:{to:"/home"}},[t._v("\n                            繼續\n                            "),n("i",{staticClass:"fa fa-arrow-right",attrs:{"aria-hidden":"true"}})])],1):t._e()]),"success"===t.status?n("div",{staticClass:"col-md-12"},[n("span",{staticClass:"vab-success",attrs:{for:""}},[t._v("*通關密語正確，請點選繼續")])]):"failed"===t.status?n("div",{staticClass:"col-md-12"},[n("span",{staticClass:"vab-failed",attrs:{for:""}},[t._v("*您的通關密語錯誤，請再試一次")])]):t._e()])])])},W=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-md-12"},[n("label",{staticClass:"label vab-label",attrs:{for:""}},[t._v("請說出通關密語")])])}],B=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.status="",t.asr="",t.passed=["一二三四","1234",1234],t}return Object(l["a"])(e,t),Object(o["a"])(e,[{key:"mounted",value:function(){var t=this;this.$on("olami",function(e){t.asr=e,t.status=-1!==t.passed.indexOf(e)?"success":"failed"})}}]),e}(p["d"]);B=d["a"]([p["a"]],B);var I=B,K=I,V=Object(w["a"])(K,J,W,!1,null,null,null);V.options.__file="Login.vue";var z=V.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{action:""}},[n("div",{staticClass:"input-group say-password"},[n("div",{staticClass:"row"},[t._m(0),n("div",{staticClass:"col-md-12"},[n("div",{staticClass:"col-md-6 col-md-push-3"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.asr,expression:"asr"}],staticClass:"form-control vab-input",attrs:{type:"text",readonly:"readonly"},domProps:{value:t.asr},on:{input:function(e){e.target.composing||(t.asr=e.target.value)}}})]),t._m(1)]),n("div",{staticClass:"col-md-8 col-md-push-2"},[n("div",{staticClass:"vab-answer",attrs:{id:"vab-answer"}},[n("p",{staticClass:"vab-answer-text"},[t._v(t._s(t.nli))])])])])])])},Q=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-md-12"},[n("label",{staticClass:"label vab-label",attrs:{for:""}},[t._v("恭喜你，進入氣象語音答詢系統！"),n("br"),t._v("請問你想詢問的是")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-md-1 col-md-push-3"},[n("div",{staticClass:"btn-group vab-prompt"},[n("button",{staticClass:"btn dropdown-toggle",attrs:{type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[n("i",{staticClass:"fa fa-question-circle-o",attrs:{"aria-hidden":"true"}})]),n("ul",{staticClass:"dropdown-menu prompt-menu"},[n("li",[t._v("必要：地點（縣/市/鄉/鎮）主題（天氣）")]),n("li",[t._v("輔助：時間（日期/後天/明天）五日以內")]),n("li",[t._v("範例："),n("br"),t._v("高雄天氣"),n("br"),t._v("請問永和週末會不會下雨"),n("br"),t._v("台中明天氣溫")])])])])}],Y=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.asr="高雄明天天氣",t.nli="高雄明天多雲中雨，最高溫度22.9℃，最低溫度18.5℃，南南西風軟風",t}return Object(l["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){this.$parent.$emit("showLoading",!0)}},{key:"mounted",value:function(){var t=this;this.$parent.$emit("showLoading",!1),this.$on("olami",function(){var e=Object(_["a"])(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.nli=r,t.asr=n;case 2:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}())}}]),e}(p["d"]);Y=d["a"]([p["a"]],Y);var Z=Y,tt=Z,et=Object(w["a"])(tt,G,Q,!1,null,null,null);et.options.__file="Home.vue";var nt=et.exports;r["default"].use(X["a"]);var rt=new X["a"]({mode:"history",base:"/",routes:[{path:"/",name:"login",component:z},{path:"/home",name:"home",component:nt}]}),at=n("2f62");r["default"].use(at["a"]);var it=new at["a"].Store({state:{},mutations:{},actions:{}}),st=n("9483");Object(st["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),$.a.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";var ot=document.head.querySelector('meta[name="csrf-token"]');ot&&($.a.defaults.headers.common["X-CSRF-TOKEN"]=ot.content),r["default"].config.productionTip=!1,new r["default"]({router:rt,store:it,render:function(t){return t(H)}}).$mount("#app")},fa76:function(t,e,n){"use strict";var r=n("91da"),a=n.n(r);a.a}});
//# sourceMappingURL=app.03ce062f.js.map